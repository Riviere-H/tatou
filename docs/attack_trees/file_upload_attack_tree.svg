<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: FileUploadAttackTree Pages: 1 -->
<svg width="1947pt" height="260pt"
 viewBox="0.00 0.00 1946.50 260.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 256)">
<title>FileUploadAttackTree</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-256 1942.5,-256 1942.5,4 -4,4"/>
<!-- Compromise File Storage / Watermarked PDFs -->
<g id="node1" class="node">
<title>Compromise File Storage / Watermarked PDFs</title>
<ellipse fill="red" stroke="black" cx="1287" cy="-234" rx="228.56" ry="18"/>
<text text-anchor="middle" x="1287" y="-230.3" font-family="Times,serif" font-size="14.00">Compromise File Storage / Watermarked PDFs</text>
</g>
<!-- Upload Malicious File -->
<g id="node2" class="node">
<title>Upload Malicious File</title>
<polygon fill="orange" stroke="black" points="1255,-180 1083,-180 1083,-144 1255,-144 1255,-180"/>
<text text-anchor="middle" x="1169" y="-158.3" font-family="Times,serif" font-size="14.00">Upload Malicious File</text>
</g>
<!-- Compromise File Storage / Watermarked PDFs&#45;&gt;Upload Malicious File -->
<g id="edge1" class="edge">
<title>Compromise File Storage / Watermarked PDFs&#45;&gt;Upload Malicious File</title>
<path fill="none" stroke="black" d="M1258.44,-216.05C1242.9,-206.84 1223.48,-195.32 1206.71,-185.37"/>
<polygon fill="black" stroke="black" points="1208.1,-182.12 1197.71,-180.03 1204.53,-188.14 1208.1,-182.12"/>
</g>
<!-- Watermark Removal -->
<g id="node6" class="node">
<title>Watermark Removal</title>
<polygon fill="orange" stroke="black" points="1691,-180 1529,-180 1529,-144 1691,-144 1691,-180"/>
<text text-anchor="middle" x="1610" y="-158.3" font-family="Times,serif" font-size="14.00">Watermark Removal</text>
</g>
<!-- Compromise File Storage / Watermarked PDFs&#45;&gt;Watermark Removal -->
<g id="edge2" class="edge">
<title>Compromise File Storage / Watermarked PDFs&#45;&gt;Watermark Removal</title>
<path fill="none" stroke="black" d="M1361.1,-216.94C1408.86,-206.59 1471.2,-193.08 1521.55,-182.17"/>
<polygon fill="black" stroke="black" points="1522.42,-185.56 1531.45,-180.02 1520.94,-178.72 1522.42,-185.56"/>
</g>
<!-- Bypass Type Check -->
<g id="node3" class="node">
<title>Bypass Type Check</title>
<polygon fill="yellow" stroke="black" points="494.5,-108 339.5,-108 339.5,-72 494.5,-72 494.5,-108"/>
<text text-anchor="middle" x="417" y="-86.3" font-family="Times,serif" font-size="14.00">Bypass Type Check</text>
</g>
<!-- Upload Malicious File&#45;&gt;Bypass Type Check -->
<g id="edge3" class="edge">
<title>Upload Malicious File&#45;&gt;Bypass Type Check</title>
<path fill="none" stroke="black" d="M1082.74,-152.97C938.53,-139.55 650.07,-112.7 504.83,-99.18"/>
<polygon fill="black" stroke="black" points="504.91,-95.67 494.63,-98.23 504.26,-102.64 504.91,-95.67"/>
</g>
<!-- Exploit PDF Parser -->
<g id="node4" class="node">
<title>Exploit PDF Parser</title>
<polygon fill="yellow" stroke="black" points="1144,-108 990,-108 990,-72 1144,-72 1144,-108"/>
<text text-anchor="middle" x="1067" y="-86.3" font-family="Times,serif" font-size="14.00">Exploit PDF Parser</text>
</g>
<!-- Upload Malicious File&#45;&gt;Exploit PDF Parser -->
<g id="edge4" class="edge">
<title>Upload Malicious File&#45;&gt;Exploit PDF Parser</title>
<path fill="none" stroke="black" d="M1144.05,-143.88C1130.96,-134.89 1114.74,-123.76 1100.56,-114.03"/>
<polygon fill="black" stroke="black" points="1102.27,-110.96 1092.05,-108.19 1098.31,-116.73 1102.27,-110.96"/>
</g>
<!-- Path Traversal / Overwrite -->
<g id="node5" class="node">
<title>Path Traversal / Overwrite</title>
<polygon fill="yellow" stroke="black" points="1476,-108 1270,-108 1270,-72 1476,-72 1476,-108"/>
<text text-anchor="middle" x="1373" y="-86.3" font-family="Times,serif" font-size="14.00">Path Traversal / Overwrite</text>
</g>
<!-- Upload Malicious File&#45;&gt;Path Traversal / Overwrite -->
<g id="edge5" class="edge">
<title>Upload Malicious File&#45;&gt;Path Traversal / Overwrite</title>
<path fill="none" stroke="black" d="M1218.64,-143.97C1247.27,-134.14 1283.45,-121.73 1313.58,-111.39"/>
<polygon fill="black" stroke="black" points="1314.81,-114.67 1323.13,-108.11 1312.54,-108.05 1314.81,-114.67"/>
</g>
<!-- Craft faked PDF header -->
<g id="node7" class="node">
<title>Craft faked PDF header</title>
<polygon fill="lightblue" stroke="black" points="186,-36 0,-36 0,0 186,0 186,-36"/>
<text text-anchor="middle" x="93" y="-14.3" font-family="Times,serif" font-size="14.00">Craft faked PDF header</text>
</g>
<!-- Bypass Type Check&#45;&gt;Craft faked PDF header -->
<g id="edge6" class="edge">
<title>Bypass Type Check&#45;&gt;Craft faked PDF header</title>
<path fill="none" stroke="black" d="M339.39,-72.23C292.02,-62 231.28,-48.88 181.96,-38.22"/>
<polygon fill="lightgreen" stroke="black" points="182.45,-34.75 171.94,-36.06 180.98,-41.59 182.45,-34.75"/>
</g>
<!-- Rename extension to .pdf -->
<g id="node8" class="node">
<title>Rename extension to .pdf</title>
<polygon fill="lightblue" stroke="black" points="403.5,-36 204.5,-36 204.5,0 403.5,0 403.5,-36"/>
<text text-anchor="middle" x="304" y="-14.3" font-family="Times,serif" font-size="14.00">Rename extension to .pdf</text>
</g>
<!-- Bypass Type Check&#45;&gt;Rename extension to .pdf -->
<g id="edge7" class="edge">
<title>Bypass Type Check&#45;&gt;Rename extension to .pdf</title>
<path fill="none" stroke="black" d="M389.36,-71.88C374.58,-62.72 356.21,-51.34 340.3,-41.48"/>
<polygon fill="lightgreen" stroke="black" points="342.09,-38.48 331.75,-36.19 338.41,-44.43 342.09,-38.48"/>
</g>
<!-- File type mismatch -->
<g id="node15" class="node">
<title>File type mismatch</title>
<polygon fill="pink" stroke="black" points="638.18,-10.54 638.18,-25.46 574.81,-36 485.19,-36 421.82,-25.46 421.82,-10.54 485.19,0 574.81,0 638.18,-10.54"/>
<text text-anchor="middle" x="530" y="-14.3" font-family="Times,serif" font-size="14.00">File type mismatch</text>
</g>
<!-- Bypass Type Check&#45;&gt;File type mismatch -->
<g id="edge14" class="edge">
<title>Bypass Type Check&#45;&gt;File type mismatch</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M444.64,-71.88C459.42,-62.72 477.79,-51.34 493.7,-41.48"/>
<polygon fill="red" stroke="red" points="495.59,-44.43 502.25,-36.19 491.91,-38.48 495.59,-44.43"/>
</g>
<!-- Malformed object streams -->
<g id="node9" class="node">
<title>Malformed object streams</title>
<polygon fill="lightblue" stroke="black" points="861.5,-36 656.5,-36 656.5,0 861.5,0 861.5,-36"/>
<text text-anchor="middle" x="759" y="-14.3" font-family="Times,serif" font-size="14.00">Malformed object streams</text>
</g>
<!-- Exploit PDF Parser&#45;&gt;Malformed object streams -->
<g id="edge8" class="edge">
<title>Exploit PDF Parser&#45;&gt;Malformed object streams</title>
<path fill="none" stroke="black" d="M992.05,-71.97C947.34,-61.8 890.44,-48.87 844.05,-38.33"/>
<polygon fill="lightgreen" stroke="black" points="844.55,-34.85 834.02,-36.05 843,-41.68 844.55,-34.85"/>
</g>
<!-- Embedded JavaScript -->
<g id="node10" class="node">
<title>Embedded JavaScript</title>
<polygon fill="lightblue" stroke="black" points="1050.5,-36 879.5,-36 879.5,0 1050.5,0 1050.5,-36"/>
<text text-anchor="middle" x="965" y="-14.3" font-family="Times,serif" font-size="14.00">Embedded JavaScript</text>
</g>
<!-- Exploit PDF Parser&#45;&gt;Embedded JavaScript -->
<g id="edge9" class="edge">
<title>Exploit PDF Parser&#45;&gt;Embedded JavaScript</title>
<path fill="none" stroke="black" d="M1042.05,-71.88C1028.96,-62.89 1012.74,-51.76 998.56,-42.03"/>
<polygon fill="lightgreen" stroke="black" points="1000.27,-38.96 990.05,-36.19 996.31,-44.73 1000.27,-38.96"/>
</g>
<!-- High file error rate -->
<g id="node16" class="node">
<title>High file error rate</title>
<polygon fill="pink" stroke="black" points="1281.86,-10.54 1281.86,-25.46 1219.26,-36 1130.74,-36 1068.14,-25.46 1068.14,-10.54 1130.74,0 1219.26,0 1281.86,-10.54"/>
<text text-anchor="middle" x="1175" y="-14.3" font-family="Times,serif" font-size="14.00">High file error rate</text>
</g>
<!-- Exploit PDF Parser&#45;&gt;High file error rate -->
<g id="edge15" class="edge">
<title>Exploit PDF Parser&#45;&gt;High file error rate</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1093.42,-71.88C1107.41,-62.81 1124.78,-51.55 1139.89,-41.76"/>
<polygon fill="red" stroke="red" points="1141.99,-44.57 1148.48,-36.19 1138.18,-38.69 1141.99,-44.57"/>
</g>
<!-- Use ../ in filename -->
<g id="node11" class="node">
<title>Use ../ in filename</title>
<polygon fill="lightblue" stroke="black" points="1446,-36 1300,-36 1300,0 1446,0 1446,-36"/>
<text text-anchor="middle" x="1373" y="-14.3" font-family="Times,serif" font-size="14.00">Use ../ in filename</text>
</g>
<!-- Path Traversal / Overwrite&#45;&gt;Use ../ in filename -->
<g id="edge10" class="edge">
<title>Path Traversal / Overwrite&#45;&gt;Use ../ in filename</title>
<path fill="none" stroke="black" d="M1373,-71.7C1373,-63.98 1373,-54.71 1373,-46.11"/>
<polygon fill="lightgreen" stroke="black" points="1376.5,-46.1 1373,-36.1 1369.5,-46.1 1376.5,-46.1"/>
</g>
<!-- Race condition overwrite -->
<g id="node12" class="node">
<title>Race condition overwrite</title>
<polygon fill="lightblue" stroke="black" points="1659.5,-36 1464.5,-36 1464.5,0 1659.5,0 1659.5,-36"/>
<text text-anchor="middle" x="1562" y="-14.3" font-family="Times,serif" font-size="14.00">Race condition overwrite</text>
</g>
<!-- Path Traversal / Overwrite&#45;&gt;Race condition overwrite -->
<g id="edge11" class="edge">
<title>Path Traversal / Overwrite&#45;&gt;Race condition overwrite</title>
<path fill="none" stroke="black" d="M1419.23,-71.88C1445.53,-62.14 1478.64,-49.87 1506.36,-39.61"/>
<polygon fill="lightgreen" stroke="black" points="1507.75,-42.82 1515.92,-36.07 1505.32,-36.26 1507.75,-42.82"/>
</g>
<!-- Unexpected file sizes -->
<g id="node17" class="node">
<title>Unexpected file sizes</title>
<polygon fill="pink" stroke="black" points="1914.37,-10.54 1914.37,-25.46 1845.03,-36 1746.97,-36 1677.63,-25.46 1677.63,-10.54 1746.97,0 1845.03,0 1914.37,-10.54"/>
<text text-anchor="middle" x="1796" y="-14.3" font-family="Times,serif" font-size="14.00">Unexpected file sizes</text>
</g>
<!-- Path Traversal / Overwrite&#45;&gt;Unexpected file sizes -->
<g id="edge16" class="edge">
<title>Path Traversal / Overwrite&#45;&gt;Unexpected file sizes</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1475.94,-71.97C1547.23,-60.17 1641.11,-44.63 1708.73,-33.44"/>
<polygon fill="red" stroke="red" points="1709.64,-36.84 1718.93,-31.75 1708.49,-29.93 1709.64,-36.84"/>
</g>
<!-- Reverse watermark algorithm -->
<g id="node13" class="node">
<title>Reverse watermark algorithm</title>
<polygon fill="lightblue" stroke="black" points="1725.5,-108 1494.5,-108 1494.5,-72 1725.5,-72 1725.5,-108"/>
<text text-anchor="middle" x="1610" y="-86.3" font-family="Times,serif" font-size="14.00">Reverse watermark algorithm</text>
</g>
<!-- Watermark Removal&#45;&gt;Reverse watermark algorithm -->
<g id="edge12" class="edge">
<title>Watermark Removal&#45;&gt;Reverse watermark algorithm</title>
<path fill="none" stroke="black" d="M1610,-143.7C1610,-135.98 1610,-126.71 1610,-118.11"/>
<polygon fill="yellow" stroke="black" points="1613.5,-118.1 1610,-108.1 1606.5,-118.1 1613.5,-118.1"/>
</g>
<!-- Process and rewrite PDF -->
<g id="node14" class="node">
<title>Process and rewrite PDF</title>
<polygon fill="lightblue" stroke="black" points="1938.5,-108 1743.5,-108 1743.5,-72 1938.5,-72 1938.5,-108"/>
<text text-anchor="middle" x="1841" y="-86.3" font-family="Times,serif" font-size="14.00">Process and rewrite PDF</text>
</g>
<!-- Watermark Removal&#45;&gt;Process and rewrite PDF -->
<g id="edge13" class="edge">
<title>Watermark Removal&#45;&gt;Process and rewrite PDF</title>
<path fill="none" stroke="black" d="M1666.21,-143.97C1698.91,-134.06 1740.3,-121.51 1774.6,-111.12"/>
<polygon fill="yellow" stroke="black" points="1775.98,-114.36 1784.53,-108.11 1773.95,-107.66 1775.98,-114.36"/>
</g>
</g>
</svg>
